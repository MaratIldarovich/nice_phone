"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var _createClass=function(){function e(e,t){for(var s=0;s<t.length;s++){var n=t[s];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,s,n){return s&&e(t.prototype,s),n&&e(t,n),t}}();!function(){var e=/[^0-9]/g,t={Delete:[46],Backspace:[8],ArrowLeft:[37],ArrowRight:[39],F5:[116],number:[48,49,50,51,52,53,54,55,56,57,96,97,98,99,100,101,102,103,104,105]},s="n",n=Object.keys(t),r=function(){function r(e){var a=this;_classCallCheck(this,r),this.element=e.element,this.emptyChar=e.emptyChar||"",this.pattern=e.pattern,this.specials=[];var i=this,l=this.element,u=this.pattern.split(s);this.numOfNumbers=u.length-1,u.filter(function(e,t,s){return e&&s.indexOf(e)===t}).forEach(function(e,t){a.specials=a.specials.concat(0===t?e:e.split(""))}),l.addEventListener("click",function(e){i._isCorrectPos()||i._setPos(i._getMinPos())}),l.addEventListener("keydown",function(e){var s=e.key;s||!function(){var r=e.keyCode||e.which;n.every(function(e){return t[e].indexOf(r)===-1||(s=e,!1)})}();var r=1*s>=0||"number"===s;if(!e.ctrlKey&&n.indexOf(s)===-1&&!r&&!e.metaKey)return void e.preventDefault();switch(i.lastKey=s,s){case"Backspace":case"ArrowLeft":case"ArrowRight":i._isCorrectPos(s)||(e.preventDefault(),i._setPos(i._getMinPos()))}}),l.addEventListener("paste",function(e){var t=i._getPos(),s=e.clipboardData,n=s.getData("text");n=i.filterStr(n),n.length>i.numOfNumbers&&(n=n.slice(-i.numOfNumbers)),e.preventDefault();var r=this.value.substr(0,t)+n+this.value.substr(t+n.length),a=i.passStr(r),l=i._getNewPos(a,null,n,t);this.value=a,i._setPos(l,l)}),l.addEventListener("input",function(e){var t=i.passStr(this.value),s=i._getNewPos(t,i.lastKey,null,i._getPos());this.value=t,i._setPos(s,s)}),this.updateFromRaw("")}return _createClass(r,[{key:"filterStr",value:function(t){return 0===t.lastIndexOf(this.specials[0])&&(t=t.slice(this.specials[0].length)),t=t.replace(e,"")}},{key:"passStr",value:function(e){for(var t=this.filterStr(e),n="",r=0,a=0;(r<t.length||this.emptyChar)&&a<this.pattern.length;r++,a++){for(var i=t[r]||this.emptyChar;this.pattern[a]!==s;)n+=this.pattern[a],a++;n+=i}return n}},{key:"updateFromRaw",value:function(e){e=e||"",this.element.value=this.passStr(e)}},{key:"_getNewPos",value:function(e,t,s,n){var r,a;switch(t){case"Backspace":a=n+1,r=n;break;case"Delete":r=n,a=n;break;default:r=n,a=n-1,s&&(r+=s.length)}for(var i=0;i<this.specials.length;i++)for(var l=this.specials[i],u=a;u<r;u++){var c=e.substr(u,l.length)===l;c&&(r+=l.length)}return r}},{key:"_getPos",value:function(){return this.element.selectionStart}},{key:"_setPos",value:function(e){this.element.selectionStart=e,this.element.selectionEnd=e}},{key:"_isCorrectPos",value:function(e,t){t=t||this._getPos();var s=void 0;switch(e){case"ArrowRight":s=1;break;default:s=-1}t+=s;for(var n=this.element.value[t];this.specials.indexOf(n)!==-1;)t+=s,n=this.element.value[t];return n!==this.emptyChar&&this._getPos()+s>=this.specials[0].length}},{key:"_getMinPos",value:function(){var e=this.element.value.indexOf(this.emptyChar);return e=Math.max(e,this.specials[0].length)}},{key:"isValid",value:function(){return this.element.value.replace(this.emptyChar,"").length===this.pattern.length}}]),r}();window.NicePhone=r}();