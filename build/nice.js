"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var _createClass=function(){function e(e,t){for(var s=0;s<t.length;s++){var n=t[s];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,s,n){return s&&e(t.prototype,s),n&&e(t,n),t}}();!function(){var e={Delete:[46],Backspace:[8],ArrowLeft:[37],ArrowRight:[39],F5:[116],number:[48,49,50,51,52,53,54,55,56,57,96,97,98,99,100,101,102,103,104,105]},t="n",s=Object.keys(e),n=function(){function n(a){var i=this;_classCallCheck(this,n),this.element=a.element,this.emptyChar=a.emptyChar||"",this.pattern=a.pattern,this.changeCallback=a.changeCallback||null,this.specials=[];var r=this.element,l=this.pattern.split(t);this.numOfNumbers=l.length-1,l.forEach(function(e,t){i.specials=i.specials.concat(0===t?e:e.split(""))}),this.specials=this.specials.filter(function(e,t,s){return e&&s.indexOf(e)===t}),r.addEventListener("click",function(e){i._isCorrectPos()||i.setPos(i._getMinPos())}),r.addEventListener("keydown",function(t){var n=t.key;if(!n){var a=t.keyCode||t.which;s.every(function(t){return-1===e[t].indexOf(a)||(n=t,!1)})}var r=1*n>=0||"number"===n;if(!t.ctrlKey&&-1===s.indexOf(n)&&!r&&!t.metaKey)return void t.preventDefault();switch(i.lastKey=n,n){case"Backspace":case"ArrowLeft":case"ArrowRight":i._isCorrectPos(n)||(t.preventDefault(),i.setPos(i._getMinPos()))}}),r.addEventListener("paste",function(e){var t=i.getPos(),s=e.clipboardData,n=s.getData("text");n=i.filterStr(n),n.length>i.numOfNumbers&&(n=n.slice(-i.numOfNumbers)),e.preventDefault();var a=r.value.substr(0,t)+n+r.value.substr(t+n.length),l=i.passStr(a),c=i._getNewPos(l,null,n,t);r.value=l,i.setPos(c,c),"function"==typeof i.changeCallback&&i.changeCallback(l,c)}),r.addEventListener("input",function(e){var t=i.passStr(r.value),s=i._getNewPos(t,i.lastKey,null,i.getPos());r.value=t,i.setPos(s,s),"function"==typeof i.changeCallback&&i.changeCallback(t,s)}),this.element.value=this.passStr("")}return _createClass(n,[{key:"filterStr",value:function(e){return 0===e.lastIndexOf(this.specials[0])&&(e=e.slice(this.specials[0].length)),e=e.replace(/[^0-9]/g,"")}},{key:"passStr",value:function(e){for(var s=this.filterStr(e),n=this.specials[0].length,a="",i=0,r=0;(i<(s.length||n)||this.emptyChar)&&r<this.pattern.length;i++,r++){for(var l=s[i]||this.emptyChar;this.pattern[r]!==t;)a+=this.pattern[r],r++;a+=l}return a}},{key:"updateFromRaw",value:function(e){e=e||"";var t=this.passStr(e);this.element.value=t,"function"==typeof this.changeCallback&&this.changeCallback(t,null)}},{key:"getPos",value:function(){return this.element.selectionStart}},{key:"setPos",value:function(e){this.element.selectionStart=e,this.element.selectionEnd=e}},{key:"setMinPos",value:function(){this.setPos(this._getMinPos())}},{key:"focus",value:function(){this.element.focus(),this.setMinPos()}},{key:"_getNewPos",value:function(e,t,s,n){var a=void 0,i=void 0;switch(t){case"Backspace":i=n+1,a=n;break;case"Delete":a=n,i=n;break;default:a=n,i=n-1,s&&(a+=s.length)}for(var r=i;r<a;r++)for(var l=0;l<this.specials.length;l++){var c=this.specials[l],h=e.substr(r,c.length)===c;h&&(a+=c.length)}return a}},{key:"_isCorrectPos",value:function(e,t){t=t||this.getPos();var s=void 0;switch(e){case"ArrowRight":s=1;break;default:s=-1}t+=s;for(var n=this.element.value[t];-1!==this.specials.indexOf(n);)t+=s,n=this.element.value[t];return n!==this.emptyChar&&this.getPos()+s>=this.specials[0].length}},{key:"_getMinPos",value:function(){var e=this.element.value.indexOf(this.emptyChar);return e=Math.max(e,this.specials[0].length)}},{key:"isValid",value:function(){return this.element.value.replace(this.emptyChar,"").length===this.pattern.length}}]),n}();window.NicePhone=n}();